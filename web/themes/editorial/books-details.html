{% extends "layout.html" %}

{% block content %}

{% macro showStrings(title, values, showHref=false) %}
{% if values|trimspace %}
<div>{{title}}:<br>
    {% for value in values|split:"; " %}<a class="button"{% if showHref %} href="/?q={{value|safe}}"{% endif %}>{{value}}</a>{% endfor %}
</div>
{% endif %}
{% endmacro %}

<section>
    <header class="main"><h1>{{book.Index.Titles|split:"; "|first}}</h1></header>
    
    <div>
        {% for img in book.Details.Images %}
        <img src="data:{{img.Type}};base64,{{img.Data}}" style="max-width: 100%; float: left;margin: 0 30px 30px 0;"/>
        {% endfor %}
        {{book.Details.Annotation|safe}}
    </div>
    <br>
    <a href="/download/{{book.Index.ID}}.fb2" class="button primary"><span class="fa fa-download"></span>&nbsp;.fb2 ({{book.Size|filesize}})</a>
    <a href="/download/{{book.Index.ID}}.epub" class="button primary"><span class="fa fa-download"></span>&nbsp;.epub</a>
    <br>
    <div class="book-descr" style="clear: both;">
        {{ showStrings("ISBN", book.Index.ISBN, true) }}
        {{ showStrings("Названия", book.Index.Titles, true) }}
        {{ showStrings("Авторы/Переводчики", book.Index.Authors, true) }}
        {{ showStrings("Серии", book.Index.Sequences, true) }}
        {{ showStrings("Дата", book.Index.Date, true) }}
        {{ showStrings("Жанры", book.Index.Genres, true) }}
        {{ showStrings("Издатели", book.Index.Publisher, true) }}
        {{ showStrings("Язык", book.Index.Lang, true) }}
    </div>
</section>
{% endblock %}
